<?xml version="1.0" encoding="utf-8"?>

<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:pageModels="clr-namespace:TB.DanceDance.Mobile.PageModels"
             xmlns:toolkit="http://schemas.microsoft.com/dotnet/2022/maui/toolkit"
             xmlns:storage="clr-namespace:Microsoft.Maui.Storage;assembly=Microsoft.Maui.Essentials"
             xmlns:controls="clr-namespace:TB.DanceDance.Mobile.Pages.Controls"
             x:DataType="pageModels:UploadVideoPageModel"
             x:Name="UploadVideoPageView"
             x:Class="TB.DanceDance.Mobile.Pages.UploadVideoPage">
    <ContentPage.Behaviors>
        <toolkit:EventToCommandBehavior
            EventName="Appearing"
            BindingContext="{Binding Path=BindingContext, 
        Source={x:Reference UploadVideoPageView}, 
        x:DataType=pageModels:UploadVideoPageModel}"
            Command="{Binding AppearingCommand}">
        </toolkit:EventToCommandBehavior>
    </ContentPage.Behaviors>
    <ContentPage.Content>
        <Grid Margin="10, 0, 10, 0">
            <VerticalStackLayout Spacing="10">
                <Picker
                    IsVisible="{Binding GroupSelectorAvailable}"
                    ItemsSource="{Binding Groups}"
                    ItemDisplayBinding="{Binding Name}"
                    SelectedIndex="{Binding SelectedGroupIndex}"
                    Title="Wybierz Grupę">
                </Picker>
                <ActivityIndicator IsRunning="true" IsVisible="{Binding UploadButtonPressed}" />
                <Button Text="Wybierz Nagranie" Command="{Binding PickVideosCommand}" />
                <VerticalStackLayout
                    BindableLayout.ItemsSource="{Binding SelectedFiles}">
                    <BindableLayout.ItemTemplate>
                        <DataTemplate x:DataType="storage:FileResult">
                            <Border>
                                <VerticalStackLayout Spacing="10">
                                    <Label Text="{Binding FileName}" FontSize="24" />
                                </VerticalStackLayout>
                            </Border>
                        </DataTemplate>
                    </BindableLayout.ItemTemplate>
                </VerticalStackLayout>
                <Button Text="Wyślij" IsEnabled="{Binding UploadButtonEnabled}"
                        Command="{Binding UploadSelectedVideosCommand}" />
            </VerticalStackLayout>
        </Grid>
    </ContentPage.Content>
</ContentPage>